source('E:/Universite de Genève/Faculté d\'économie/Mon Master en statistique/A1S2/Sampling Techniques/TP1_R_Solutions.R', echo=TRUE)
#HV
setwd("E:/Universite de Genève/Faculté d'économie/Mon Master en statistique/A1S2/Analytics Consulting/analytics-consulting/A")
source('E:/Universite de Genève/Faculté d\'économie/Mon Master en statistique/A1S2/Analytics Consulting/analytics-consulting/A/script.r', echo=TRUE)
library(tidyverse)
library(ggmosaic)
library(gghalves)
clothing <- read_excel("Aclothing.xls")
# I rename it because I got too much headaches (same name :p )
clothing <- clothing %>%
rename(
ClothingType = Clothing
)
clothing$ClothingType <- as.factor(clothing$ClothingType)
clothing$Gender <- as.factor(clothing$Gender)
#HV
setwd("E:/Universite de Genève/Faculté d'économie/Mon Master en statistique/A1S2/Analytics Consulting/analytics-consulting/A")
library(tidyverse)
library(ggmosaic)
library(gghalves)
clothing <- read_excel("Aclothing.xls")
library(readxl)
library(tidyverse)
library(ggmosaic)
library(gghalves)
clothing <- read_excel("Aclothing.xls")
# I rename it because I got too much headaches (same name :p )
clothing <- clothing %>%
rename(
ClothingType = Clothing
)
clothing$ClothingType <- as.factor(clothing$ClothingType)
clothing$Gender <- as.factor(clothing$Gender)
clothing$InteractionType <- as.factor(clothing$InteractionType)
str(clothing)
head(clothing)
attach(clothing)
boxplot(clot)
clothing %>% ggplot(aes(x=ClothingType,
y=Count)) +
geom_jitter(height = 0.25,width = 0.25, alpha = 0.4) +
geom_smooth(se = FALSE) +
theme_minimal() +
labs(title="Relation between clothing and number of interactions",
x="Clothing Type",
y="Number of interactions",
caption="Figure 1") +
ggsave("figures/fig1.png")
clothing %>% ggplot(aes(x=ClothingType,
y=Count,
fill=ClothingType)) +
geom_half_boxplot(alpha = 0.6) +
geom_half_violin(side="r", alpha=0.4, bw=0.45) +
theme(legend.position = "none") +
theme_minimal() +
labs(title="Relation between clothing and number of interactions",
x="Clothing Type",
y="Number of interactions",
caption="Figure 2") +
guides(fill = FALSE)+
coord_flip()+
scale_fill_viridis_d(begin = 0.1, end = 0.8) +
ggsave("figures/fig2.png")
clothing %>% ggplot(aes(x=Gender,
y=Count)) +
geom_jitter(height = 0.25,width = 0.25, alpha = 0.4) +
geom_smooth(se = FALSE) +
theme_minimal() +
labs(title="Relation between gender and number of interactions",
x="Gender",
y="Number of interactions",
caption="Figure 3")+
ggsave("figures/fig3.png")
clothing %>% ggplot(aes(x=Gender,
y=Count,
fill=Gender)) +
geom_half_boxplot(alpha = 0.6) +
geom_half_violin(side="r", alpha=0.4, bw=0.45) +
theme(legend.position = "none") +
theme_minimal() +
labs(title="Relation between gender and number of interactions",
x="Gender",
y="Number of interactions",
caption="Figure 4") +
guides(fill = FALSE)+
coord_flip()+
scale_fill_viridis_d(begin = 0.1, end = 0.8)+
ggsave("figures/fig4.png")
clothing %>% ggplot(aes(x=ClothingType,
y=InteractionType)) +
geom_jitter(height = 0.25,width = 0.25, alpha = 0.4) +
geom_smooth(se = FALSE) +
theme_minimal() +
labs(title="Relation between clothing and type of interactions",
x="Clothing Type",
y="Type of Interactions",
caption="Figure 5")+
ggsave("figures/fig5.png")
clothing %>% ggplot(aes(x=Gender,
y=InteractionType)) +
geom_jitter(height = 0.25,width = 0.25, alpha = 0.35) +
geom_smooth(se = FALSE) +
theme_minimal() +
labs(title="Relation between gender and type of interactions",
x="Gender",
y="Type of Interactions",
caption="Figure 6")+
ggsave("figures/fig6.png")
clothing.lme <- lm(Count ~ Gender + ClothingType + Gender*ClothingType)
summary(clothing.lme)
plot(clothing.lme)
clothing <- read_excel("Aclothing.xls")
# I rename it because I got too much headaches (same name :p )
clothing <- clothing %>%
rename(
ClothingType = Clothing
)
clothing$ClothingType <- as.factor(clothing$ClothingType)
clothing$Gender <- as.factor(clothing$Gender)
clothing$InteractionType <- as.factor(clothing$InteractionType)
str(clothing)
head(clothing)
attach(clothing)
boxplot(clot)
boxplot(clothing)
clothing %>% ggplot(aes(x=ClothingType,
y=Count)) +
geom_jitter(height = 0.25,width = 0.25, alpha = 0.4) +
geom_smooth(se = FALSE) +
theme_minimal() +
labs(title="Relation between clothing and number of interactions",
x="Clothing Type",
y="Number of interactions",
caption="Figure 1") +
ggsave("figures/fig1.png")
clothing %>% ggplot(aes(x=ClothingType,
y=Count,
fill=ClothingType)) +
geom_half_boxplot(alpha = 0.6) +
geom_half_violin(side="r", alpha=0.4, bw=0.45) +
theme(legend.position = "none") +
theme_minimal() +
labs(title="Relation between clothing and number of interactions",
x="Clothing Type",
y="Number of interactions",
caption="Figure 2") +
guides(fill = FALSE)+
coord_flip()+
scale_fill_viridis_d(begin = 0.1, end = 0.8) +
ggsave("figures/fig2.png")
clothing %>% ggplot(aes(x=Gender,
y=Count)) +
geom_jitter(height = 0.25,width = 0.25, alpha = 0.4) +
geom_smooth(se = FALSE) +
theme_minimal() +
labs(title="Relation between gender and number of interactions",
x="Gender",
y="Number of interactions",
caption="Figure 3")+
ggsave("figures/fig3.png")
clothing %>% ggplot(aes(x=Gender,
y=Count,
fill=Gender)) +
geom_half_boxplot(alpha = 0.6) +
geom_half_violin(side="r", alpha=0.4, bw=0.45) +
theme(legend.position = "none") +
theme_minimal() +
labs(title="Relation between gender and number of interactions",
x="Gender",
y="Number of interactions",
caption="Figure 4") +
guides(fill = FALSE)+
coord_flip()+
scale_fill_viridis_d(begin = 0.1, end = 0.8)+
ggsave("figures/fig4.png")
clothing %>% ggplot(aes(x=ClothingType,
y=InteractionType)) +
geom_jitter(height = 0.25,width = 0.25, alpha = 0.4) +
geom_smooth(se = FALSE) +
theme_minimal() +
labs(title="Relation between clothing and type of interactions",
x="Clothing Type",
y="Type of Interactions",
caption="Figure 5")+
ggsave("figures/fig5.png")
clothing %>% ggplot(aes(x=Gender,
y=InteractionType)) +
geom_jitter(height = 0.25,width = 0.25, alpha = 0.35) +
geom_smooth(se = FALSE) +
theme_minimal() +
labs(title="Relation between gender and type of interactions",
x="Gender",
y="Type of Interactions",
caption="Figure 6")+
ggsave("figures/fig6.png")
clothing %>% ggplot(aes(x=ClothingType,
y=InteractionType)) +
geom_jitter(height = 0.25,width = 0.25, alpha = 0.4) +
geom_smooth(se = FALSE) +
theme_minimal() +
labs(title="Relation between clothing and type of interactions",
x="Clothing Type",
y="Type of Interactions",
caption="Figure 5")+
ggsave("figures/fig5.png")
clothing %>% ggplot(aes(x=ClothingType,
y=InteractionType)) +
geom_boxplot(height = 0.25,width = 0.25, alpha = 0.4) +
theme_minimal() +
labs(title="Relation between clothing and type of interactions",
x="Clothing Type",
y="Type of Interactions",
caption="Figure 5")+
ggsave("figures/fig5.png")
clothing %>% ggplot(aes(x=ClothingType,
y=InteractionType)) +
geom_jitter(height = 0.25,width = 0.25, alpha = 0.4) +
geom_smooth(se = FALSE) +
theme_minimal() +
labs(title="Relation between clothing and type of interactions",
x="Clothing Type",
y="Type of Interactions",
caption="Figure 5")+
ggsave("figures/fig5.png")
clothing %>% ggplot(aes(x=Gender,
y=InteractionType)) +
geom_jitter(height = 0.25,width = 0.25, alpha = 0.35) +
geom_smooth(se = FALSE) +
theme_minimal() +
labs(title="Relation between gender and type of interactions",
x="Gender",
y="Type of Interactions",
caption="Figure 6")+
ggsave("figures/fig6.png")
clothing %>% ggplot(aes(x=ClothingType,
y=Count)) +
geom_jitter(height = 0.25,width = 0.25, alpha = 0.4) +
geom_smooth(se = FALSE) +
theme_minimal() +
labs(title="Relation between clothing and number of interactions",
x="Clothing Type",
y="Number of interactions",
caption="Figure 1") +
ggsave("figures/fig1.png")
clothing %>% ggplot(aes(x=ClothingType,
y=Count,
fill=ClothingType)) +
geom_half_boxplot(alpha = 0.6) +
geom_half_violin(side="r", alpha=0.4, bw=0.45) +
theme(legend.position = "none") +
theme_minimal() +
labs(title="Relation between clothing and number of interactions",
x="Clothing Type",
y="Number of interactions",
caption="Figure 2") +
guides(fill = FALSE)+
coord_flip()+
scale_fill_viridis_d(begin = 0.1, end = 0.8) +
ggsave("figures/fig2.png")
clothing %>% ggplot(aes(x=Gender,
y=Count)) +
geom_jitter(height = 0.25,width = 0.25, alpha = 0.4) +
geom_smooth(se = FALSE) +
theme_minimal() +
labs(title="Relation between gender and number of interactions",
x="Gender",
y="Number of interactions",
caption="Figure 3")+
ggsave("figures/fig3.png")
clothing %>% ggplot(aes(x=Gender,
y=Count,
fill=Gender)) +
geom_half_boxplot(alpha = 0.6) +
geom_half_violin(side="r", alpha=0.4, bw=0.45) +
theme(legend.position = "none") +
theme_minimal() +
labs(title="Relation between gender and number of interactions",
x="Gender",
y="Number of interactions",
caption="Figure 4") +
guides(fill = FALSE)+
coord_flip()+
scale_fill_viridis_d(begin = 0.1, end = 0.8)+
ggsave("figures/fig4.png")
clothing %>% ggplot(aes(x=ClothingType,
y=InteractionType)) +
geom_jitter(height = 0.25,width = 0.25, alpha = 0.4) +
geom_smooth(se = FALSE) +
theme_minimal() +
labs(title="Relation between clothing and type of interactions",
x="Clothing Type",
y="Type of Interactions",
caption="Figure 5")+
ggsave("figures/fig5.png")
clothing %>% ggplot(aes(x=Gender,
y=InteractionType)) +
geom_jitter(height = 0.25,width = 0.25, alpha = 0.35) +
geom_smooth(se = FALSE) +
theme_minimal() +
labs(title="Relation between gender and type of interactions",
x="Gender",
y="Type of Interactions",
caption="Figure 6")+
ggsave("figures/fig6.png")
clothing.lme <- lm(Count ~ Gender + ClothingType + Gender*ClothingType)
summary(clothing.lme)
plot(clothing.lme)
# HELP!
clothing.lme <- lm(InteractionType ~ Gender + ClothingType + Gender*ClothingType)
clothing %>% ggplot(aes(x=Gender,
y=InteractionType)) +
geom_jitter(height = 0.25,width = 0.25, alpha = 0.35) +
geom_smooth(se = FALSE) +
theme_minimal() +
labs(title="Relation between gender and type of interactions",
x="Gender",
y="Type of Interactions",
caption="Figure 6")+
ggsave("figures/fig6.png")
clothing.lme <- lm(Count ~ Gender + ClothingType + Gender*ClothingType)
summary(clothing.lme)
str(clothing)
# HELP!
# set dummy variable for Male/female
clothing.lme <- lm(InteractionType ~ Gender + ClothingType + Gender*ClothingType)
# HELP!
# set dummy variable for Male/female
clothing.lme <- glm(InteractionType ~ Gender + ClothingType + Gender*ClothingType)
# HELP!
# try it with GLM
clothing.lme <- glm(InteractionType ~ Gender + ClothingType + Gender*ClothingType)
# HELP!
# try it with GLM
clothing.lme <- glm(log(InteractionType) ~ Gender + ClothingType + Gender*ClothingType)
# HELP!
# try it with GLM
clothing.glm <- glm(Count ~ Gender + ClothingType + Gender*ClothingType, family="logit")
# HELP!
# try it with GLM
clothing.glm <- glm(Count ~ Gender + ClothingType + Gender*ClothingType, family="logit")
source('E:/Universite de Genève/Faculté d\'économie/Mon Master en statistique/A1S2/Analytics Consulting/analytics-consulting/A/script.r', echo=TRUE)
# HELP!
# try it with GLM
clothing.glm <- glm(Count ~ Gender + ClothingType + Gender*ClothingType, family="logit")
